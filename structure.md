# Code structure

## Organization

- git 
- static analysis (with custom rules) 
- linter (with custom rules) 
- documentation (UML, reference) (doxygen?) 
- testing 
- compilation => Meson (CI) 

https://documentation.divio.com/

FFS = Framework Flight Software\
MFS = Mission Flight Software  

## Files

- .hpp files, .cpp files and documentation files are alongside each other

## FFS

The FFS is an abstraction layer. Here are its objectives :

- Make mission software development simple and reliable
- Simple C++ API
- Seamless communication between software components and hardware components 

FreeRTOS with https://github.com/RobinK2/ESFree / https://kth.diva-portal.org/smash/get/diva2:1085303/FULLTEXT01.pdf

## MFS

The MFS is the main mission software. It leverages the FFS.

## FFS Folder structure
    
| Folder | Explanation |
|--------|-------------|
|- test/                        ||
|----- emul/                    |QEmu|
|----- phys/                    |Hardware-in-the-loop|
|- tools/                       |have GUI/CLI tools to generate config|
|- config/                      ||
|- doc/                         ||
|----- [intro]                  ||                
|----- tutorials/               ||
|----- examples/                ||
|----- design/                  |explanation of why we made the choices|
|----- reference/               |autogenerated from comments|
|- src/                         |unit tests alongside the sources !!|
|----- module/                  |logic unit|
|---------- local/              |Software module -> continuous background tasks with an event loop, handles tasks|
|---------- remote/             |Hardware module -> has message send/receive functions|
|----- event/                   |observer-based messaging protocol between modules|
|----- task/                    |processing unit|


Message is :

    {
        msg_class : [META_SUBS | META_UNSUBS | META_ACK | META_NACK | DATA],
        msg_type : int,                  // message types are fixed at compile-time
        crc :      int,
        length :   uint,
        data :     char[length]
    }



## MFS Folder structure

| Folder | Explanation |
|--------|-------------|
|- test/                        ||
|----- emul/                    |QEmu|
|----- phys/                    |Hardware-in-the-loop|
|- tools/                       |have GUI/CLI tools to generate config|
|- config/                      ||
|- src/                         |unit tests alongside the sources !!|
|----- deps/                    |code dependencies and libraries|
|---------- FFS/                |Framework Flight Software|
|---------- AX25/               ||
|---------- CCSDS-PUS/          ||
|---------- .../                ||
|----- mission/                 |mission logic modules|
|---------- modes/              |modes|
|---------- init/               |initialization|
|---------- flightplan/         |flight plan|
|---------- attitudectl/        |attitude control algorithms|
|---------- orbitctl/           |orbit control algorithms|
|---------- pwrctl/             |monitoring and subsystem on/off depending on modes|
|---------- housekeeping/       |logging|
|---------- errorhdlr/          |error handler|
|----- modules/                 |remote modules|
|---------- tmtc/               |telemeasure / telecommunications|
|---------- eps/                |elec power unit|
|---------- adcs/               |attitude determination + control system|
|---------- ocs/                |orbit control system|
|----- arch/                    |BSP = board support package|
|----- boot/                    |bootloader|